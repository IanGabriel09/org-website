<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEWS & RESOURCES</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Bootstrap 5.3.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Data AOS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../../css/styles.css">
    
    <style>

    </style>

</head>
<body>
    <div id="nav"></div>

    <div class="content mt-5">
        <div class="container">
            <div class="text-center">
                <h3>News & Resources</h3>
            </div>
            <div id="newsContainer" class="row gy-3">
                <!-- Populated via ajax call to PHP endpoint -->
            </div>
        </div>
    </div>

    <div id="footer"></div>

    <!-- Include sheets JS -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.17.0/dist/xlsx.full.min.js"></script>
    <!-- Include google charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap 5.3.3 JS Bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Data AOS JS CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>

    <!-- Component loader script -->
    <script src="../../../_components/componentLoader.js"></script>
    <!-- Session Checker script -->
    <script src="../../js/session_check/sessionCheck.js"></script>

    <script>
        AOS.init({
            once: true // Ensures animations happen only once
        });

        function fetchNews() {
            $.ajax({
                url: './fetch_news.php',
                type: 'GET',
                dataType: 'JSON', 
                success: function(response) {
                    const div = $('#newsContainer');
                    let aosCount = 100;

                    response.forEach(function(item) {
                        let content = `
                            <div class="col-lg-4 col-md-6 col-sm-12 text-center" data-aos="fade-up" data-aos-delay="${aosCount}">
                                <p class="m-0 lead">${item.news_name} - ${item.expected_date}</p>
                                ${item.news_img ? `<img src="${item.news_img}" alt="${item.news_name}" style="max-width: 300px; max-height: 300px;">` : 'No Image'}
                                <p class="text-muted">${item.news_description}</p>
                            </div>
                        `;

                        div.append(content);
                        aosCount += 50;
                    });
                },
                error: function(xhr, status, error) {
                    alert('Internal browser error, please check browser logs.');
                    console.error(error); // Log the error for debugging
                }
            });
        }

        $(document).ready(function() {
            fetchNews();
        })
    </script>

</body>
</html>
